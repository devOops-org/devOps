## 1.1 검색시스템의 이해

검색 시스템과 검색엔진의 정의, 검색엔진인 엘라스틱 서치와 데이터베이스의 차이

### 검색 시스템이란?
- 검색엔진이란 광활한 웹에서 정보를 수집해 검색 결과를 제공하는 프로그램
- 검색시스템은 대용량 데이터를 기반으로 신회성있는 검색결과를 제공하기 위해 검색엔진을 기반으로 구축된 시스템을 통칭하는 용어
    - 수집기를 이용한 데이터 수집, 다수의 검색엔진을 이용한 색인, 검색 결과를 UI로 제공
    - 시스템 내부의 정책에 따라 특정 필드나 문서에 가중치를 둔 검색 정확도

### 검색 시스템의 구성 요소

- 정보를 수집하는 수집기
- 수집한 데이터를 저장하는 스토리지
- 수집한 데이터를 검색에 적절한 형태로 변환하는 색인기
- 색인된 데이터에서 일치하는 문서를 찾는 검색기

> 수집기
- 파일, 데이터베이스, 웹페이지 등 웹 상의 대부분의 정보가 수집대상이다.
- 파일의 경우 수집기가 파일명, 파일 내용, 파일 경로 등의 정보를 수집하여 저장하면 검색엔진이 저장된 정보를 검색하여 질의에 응답하게 된다.
> 스토리지
- 데이터베이스에서 데이터를 저장하는 물리적인 저장소
> 색인기
- 수집된 데이터를 검색 가능한 구조로 가공하고 저장
- 다양한 형태소 분석기를 조합해 정보에서 의미가 있는 용어를 추출, 검색에 유리한 역색인 구조로 데이터를 저장
> 검색기
- 사용자의 질의를 입력받아 색인기에서 저장한 역색인 구조에서 일치하는 문서를 찾아 결과로 반환
- 질의와 문서가 일치하는지는 유사도 기반의 검색 순위 알고리즘으로 판단
- 검색기 또한 색인기와 마찬가지로 형태소 분석기를 이용해 사용자 질의에서 유의미한 용어를 추출해 검색
    - 사용하는 형태소 분석기에 따라 검색 품질 차이가 발생할 수 있다.

### 관계형 데이터베이스와의 차이점
> 관계형 데이터베이스의 특징
- 데이터를 통합 관리하는 데이터의 집합
- 저장 방식에 따라 크게 관계형 또는 계층형 데이터베이스로 구분
- 모든 데이터베이스는 중복을 제거하고, 정형 데이터로 구조화해 행과 열로 구성된 테이블에 저장
- SQL 문을 이용해 원하는 정보의 검색이 가능하나 텍스트 매칭을 통한 단순한 검색만 가능
- 텍스트를 여러 단어로 변형하거나 여러 개의 동의어나 유의어를 활용한 검색은 불가능
> 검색엔진의 특징
- 비정형 데이터를 색인하고 검색
- 형태소 분석을 통해 사람이 구사하는 자연어의 처리가 가능
- 역색인 구조를 바탕으로 빠른 검색 속도를 보장

> 용어 구분

|엘라스틱서치|관계형 데이터베이스|
|:---:|:---:|
|인덱스(Index)|데이터베이스(Database)|
|샤드(shard)|파티션(partition)|
|타입(type)|테이블(table)|
|문서(document)|행(row)|
|필드(field)|열(column)|
|매핑(mapping)|스키마(schema)|
|Query DSL|SQL|

```text
* 관계형데이터베이스의 인덱스는 where 절의 쿼리와 join을 빠르게 만드는 보조 데이터 도구로 사용
* 6.0 이하 버전 하나의 인덱스 내부에 기능에 따라 데이터를 분류하고 여러 개의 타입을 만들어 사용
* 현재는 하나의 인덱스에 하나의 타입만 구성하도록 변경
```

> 요청 방식 차이

|기능|엘라스틱서치|데이터베이스|
|:----:|:----:|:----:|
|데이터의 조회|GET|SELECT|
|데이터의 생성|PUT|INSERT|
|인덱스 업데이트, 데이터 조회|POST|UPDATE, SELECT|
|데이터 삭제|DELETE|DELETE|
|인덱스의 정보 확인|HEAD|-|

```text
* RESTful API
HTTP 헤더(header)와 URL만 사용해 다양한 형태의 요청을 할 수 있는 HTTP 프로토콜을 최대한 활용하도록 고안된 아키텍처
```

- 엘라스틱 서치를 사용하기 위한 간단한 API 요청 구조

```shell
curl -X(method) http://host:port/(index)/(type)/(document id) -d '{json data}'
```
